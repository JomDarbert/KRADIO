(function(){var t,e,r,n,i,u,a,o,l,s,c,f,d,g,v,p,m,h,k,A,b,y,x,w,M,_,C,B,F=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};for(u="2721807f620a4047d473472d46865f14",SC.initialize({client_id:u}),A=100,w=["kpop","k pop","k-pop","korean","korea","kor","kor pop","korean pop","korean-pop","kor-pop","korean version","kr","kr ver","original"],e=["cover","acoustic","instrumental","remix","mix","re mix","re-mix","version","ver.","live","live cover","accapella","cvr","united states","america","india","indian","japan","china","chinese","japanese","viet","vietnam","vietnamese","thai","taiwan","taiwanese","russian","ambient","meditat"],d=/[^A-Za-z0-9\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF \♡\.\「\」\”\“\’\∞\♥\|\【\】\–\{\}\[\]\!\@\#\$\%\^\&\*\(\)\-\_\=\+\;\:\'\"\,\.\<\>\/\\\?\`\~]/g,a=/[\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF]/g,o=[],f=[],v=document.getElementById("player_one"),m=document.getElementById("player_two"),p=document.getElementById("player_three"),h=[v,m,p],l=function(){var t;return t=null,$.ajax({async:!1,global:!1,url:"../scrape/songs.json",dataType:"json",success:function(e){t=e}}),t}(),x=[],M=0,C=l.length;C>M;M++)y=l[M],x.push(y.query);for(x=arrayUnique(x),r=function(t,r){var n,i,u,a,o,l,s,c,f,g,v,p,m,h,k,A,b;if(null==t.title)return!1;if(null==t.url)return!1;if(null==t.created)return!1;if(s=12,a=moment(t.created,"YYYY-MM-DD HH:MM:SS"),o=moment().subtract(s,"months"),o.diff(a,"months")>0)return!1;for(p=0,k=e.length;k>p;p++)if(v=e[p],-1!==t.title.indexOf(v))return!1;for(m=0,A=e.length;A>m;m++)if(v=e[m],null!=t.genre&&-1!==t.genre.indexOf(v))return!1;for(h=0,b=e.length;b>h;h++)if(v=e[h],F.call(t.tags,v)>=0)return!1;return l=d.test(t.title),l===!0?!1:(u=t.title.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),i=r.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),g=u.split(" "),c=i.split(" "),n=[g,c],f=n.shift().reduce(function(t,e){return-1===t.indexOf(e)&&n.every(function(t){return-1!==t.indexOf(e)})&&t.push(e),t},[]),0===f.length?!1:!0)},n=function(t,e){var r,n,i,u,o,l,s,c,f,d,g,v,p,m;for(s=0,f=0,o=0,i=t.title.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),n=e.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),m=t.genre,F.call(w,m)>=0&&(s+=1),v=0,p=w.length;p>v;v++)d=w[v],F.call(t.tags,d)>=0&&(f+=1);return f>0&&(s+=1),g=a.test(t.title),g===!0&&(s+=1),c=i.split(" "),u=n.split(" "),r=[c,u],l=r.shift().reduce(function(t,e){return-1===t.indexOf(e)&&r.every(function(t){return-1!==t.indexOf(e)})&&t.push(e),t},[]),l.length===u.length&&(s+=1),levenstein(n,i)<=10&&(s+=1),s},s=function(t){var e;return e=$.Deferred(),SC.get("/tracks",{q:t,limit:A},function(i,a){var o;return null==i||0===i.length||null!==a?(e.reject(),void 0):(o=[],i.forEach(function(e){var i,a,l,s,c,f,d,g,v;return null!=e.title&&(d=e.title.toLowerCase()),null!=e.genre&&(c=e.genre.toLowerCase()),null!=e.tag_list&&(f=e.tag_list.toLowerCase().split(" ")),null!=e.created_at&&(l=e.created_at),null!=e.stream_url&&(g=e.stream_url+"?client_id="+u),null!=e.artwork_url&&(i=e.artwork_url.replace("-large","-t500x500")),null!=e.playback_count&&(v=e.playback_count),null!=e.duration&&(s=e.duration/1e3),y={title:d,genre:c,tags:f,created:l,url:g,artwork:i,duration:s,views:v,score:0,query:t},a=r(y,t),y.score=n(y,t),a===!0&&y.score>=2?o.push(y):void 0}),o.sort(function(t,e){var r;return r=e.score-t.score,0!==r?r:e.views-t.views}),o.length>0?e.resolve(o[0]):e.reject(),void 0)}),e.promise()},t=function(t){var e,r;e=o.length,r=9,null!=t.query&&o.unshift(t.query),e>r&&o.splice(r+1,e-r)},b=function(){var t;return t=x.filter(function(t){return o.indexOf(t)<0}),t=t.filter(function(t){return f.indexOf(t)<0}),t[Math.floor(Math.random()*t.length)]},k=function(e){var r,n;return n=function(e){return s(e).done(function(e){return t(e),r.resolve(e)}).fail(function(){var t;return f.push(e),t=b(),n(t)})},r=$.Deferred(),n(e),r.promise()},i=function(){var t,e,r,n,i,u;return h=[v,m,p],e=h.indexOf(document.getElementsByClassName("active")[0]),r=h.length-1,t=null==e||e===r?0:e+1,n=t===r?0:t+1,i=n===r?0:n+1,u={active:h[t],next:h[n],onDeck:h[i],last:h[e]},u.active.classList.add("active"),u.next.classList.remove("active"),u.onDeck.classList.remove("active"),u},Number.prototype.toHHMMSS=function(){var t,e,r;return t=Math.floor(this/3600),e=Math.floor(this%3600/60),r=Math.floor(this%3600%60),(t>0?t+":":"")+(e>0?(t>0&&10>e?"0":"")+e+":":"0:")+(10>r?"0":"")+r},c=function(){var t,e,r,n,u;return h=i(),n=b(),e=Number(h.active.getAttribute("songlength")).toHHMMSS(),t=h.active.getAttribute("artwork"),u=h.active.getAttribute("songtitle"),r=h.active.getAttribute("songlength"),h.last.pause(),h.active.play(),$("#endTime").val(e),$("#seek").attr("max",r),$("#title").text(u),$("#container").css("background","url("+t+") no-repeat center center fixed"),$("#container").css("background-size","cover"),k(n).done(function(t){return h.last.setAttribute("src",t.url),h.last.setAttribute("artwork",t.artwork),h.last.setAttribute("songtitle",t.title),h.last.setAttribute("songlength",t.duration)})},document.addEventListener("touchmove",function(t){return t.preventDefault()}),$("#nextButton").on("click",function(){return c()}),$("#playButton").on("click",function(){var t;return t=document.getElementsByClassName("active")[0],t.paused?($("#playButton").html("&#xf04c;"),t.play()):($("#playButton").html("&#xf04b;"),t.pause())}),_=0,B=h.length;B>_;_++)g=h[_],$(g).on("playing",function(){return $("#playButton").html("&#xf04c;")}),$(g).on("ended",function(){return c()}),$(g).on("timeupdate",function(){return $("#currentTime").val(this.currentTime.toHHMMSS()),$("#seek").val(this.currentTime)});$("#seek").on("input",function(){var t;return t=document.getElementsByClassName("active")[0],t.pause(),t.currentTime=this.value}),$("#seek").on("change",function(){var t;return t=document.getElementsByClassName("active")[0],t.play()}),$(document).ready(function(){var t,e,r;return t=b(),r=b(),e=b(),k(t).done(function(t){return v.setAttribute("src",t.url),v.setAttribute("artwork",t.artwork),v.setAttribute("songtitle",t.title),v.setAttribute("songlength",t.duration),$("#endTime").val(t.duration.toHHMMSS()),$("#seek").attr("max",t.duration),$("#container").css("background","url("+t.artwork+") no-repeat center center fixed"),$("#container").css("background-size","cover"),$("#title").text(t.title)}),k(r).done(function(t){return m.setAttribute("src",t.url),m.setAttribute("artwork",t.artwork),m.setAttribute("songtitle",t.title),m.setAttribute("songlength",t.duration)}),k(e).done(function(t){return p.setAttribute("src",t.url),p.setAttribute("artwork",t.artwork),p.setAttribute("songtitle",t.title),p.setAttribute("songlength",t.duration)})})}).call(this);