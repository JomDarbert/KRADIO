(function(){var e,t,r,n,a,l,i,o,u,s,c,f,g,p,h,v,d,m,k,w,x,A=[].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1};for(a="2721807f620a4047d473472d46865f14",SC.initialize({client_id:a}),d=["kpop","k pop","k-pop","korean","korea","kor","kor pop","korean pop","korean-pop","kor-pop","korean version","kr","kr ver","original"],t=["cover","acoustic","instrumental","remix","mix","re mix","re-mix","version","ver.","live","live cover","accapella","cvr","united states","america","india","indian","japan","china","chinese","japanese","viet","vietnam","vietnamese","thai","taiwan","taiwanese","russian","ambient","meditat"],f=/[^A-Za-z0-9\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF \♡\.\「\」\”\“\’\∞\♥\|\【\】\–\{\}\[\]\!\@\#\$\%\^\&\*\(\)\-\_\=\+\;\:\'\"\,\.\<\>\/\\\?\`\~]/g,u=/[\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF]/g,s=[],v="",i=function(){var e;return e=null,$.ajax({async:!1,global:!1,url:"../scrape/EYK/tutorial/eyk.json",dataType:"json",success:function(t){e=t}}),e}(),c=function(){var e;return e=null,$.ajax({async:!1,global:!1,url:"../scrape/MWAVE/tutorial/mwave.json",dataType:"json",success:function(t){e=t}}),e}(),h=[],m=0,w=i.length;w>m;m++)p=i[m],h.push(p.title);for(k=0,x=c.length;x>k;k++)p=c[k],h.push(p.artist+" "+p.title);h=arrayUnique(h),r=function(e,r){var n,a,l,i,o,u,s,c,g,p,h,v,d,m,k,w,x;if(null==e.title)return!1;if(null==e.url)return!1;if(null==e.created)return!1;if(s=12,i=moment(e.created,"YYYY-MM-DD HH:MM:SS"),o=moment().subtract(s,"months"),o.diff(i,"months")>0)return!1;for(v=0,m=t.length;m>v;v++)if(h=t[v],-1!==e.title.indexOf(h))return!1;for(d=0,k=t.length;k>d;d++)if(h=t[d],null!=e.genre&&-1!==e.genre.indexOf(h))return!1;for(x=0,w=t.length;w>x;x++)if(h=t[x],A.call(e.tags,h)>=0)return!1;return u=f.test(e.title),u===!0?!1:(l=e.title.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),a=r.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),p=l.split(" "),c=a.split(" "),n=[p,c],g=n.shift().reduce(function(e,t){return-1===e.indexOf(t)&&n.every(function(e){return-1!==e.indexOf(t)})&&e.push(t),e},[]),0===g.length?!1:!0)},n=function(e,t){var r,n,a,l,i,o,s,c,f,g,p,h,v,m;for(s=0,f=0,i=0,a=e.title.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),n=t.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),m=e.genre,A.call(d,m)>=0&&(s+=1),h=0,v=d.length;v>h;h++)g=d[h],A.call(e.tags,g)>=0&&(f+=1);return f>0&&(s+=1),p=u.test(e.title),p===!0&&(s+=1),c=a.split(" "),l=n.split(" "),r=[c,l],o=r.shift().reduce(function(e,t){return-1===e.indexOf(t)&&r.every(function(e){return-1!==e.indexOf(t)})&&e.push(t),e},[]),o.length===l.length&&(s+=1),levenstein(n,a)<=10&&(s+=1),s},o=function(e){var t;return t=$.Deferred(),console.log("Entered at: "+new Date),SC.get("/tracks",{q:e,limit:200},function(a){var l;return console.log("Got tracks: "+new Date),null==a||0===a.length?(t.resolve(!1),void 0):(l=[],a.forEach(function(t){var a,i,o,u,s,c,f,g,h;return null!=t.title&&(f=t.title.toLowerCase()),null!=t.genre&&(s=t.genre.toLowerCase()),null!=t.tag_list&&(c=t.tag_list.toLowerCase().split(" ")),null!=t.created_at&&(o=t.created_at),null!=t.stream_url&&(g=t.stream_url),null!=t.artwork_url&&(a=t.artwork_url.replace("-large","-t500x500")),null!=t.playback_count&&(h=t.playback_count),null!=t.duration&&(u=t.duration/1e3),p={title:f,genre:s,tags:c,created:o,url:g,artwork:a,duration:u,views:h,score:0,query:e},i=r(p,e),p.score=n(p,e),i===!0&&p.score>=2?l.push(p):void 0}),l.sort(function(e,t){var r;return r=t.score-e.score,0!==r?r:t.views-e.views}),l.length>0?t.resolve(l[0]):t.resolve(!1),void 0)}),t.promise()},e=function(e){return s.unshift(e.title)},g=function(){return h[Math.floor(Math.random()*h.length)]},l=0,$("#test").on("click",function(){var e,t,r,n;for(console.log(h.length+" songs"),n=[],t=0,r=h.length;r>t;t++)e=h[t],n.push(o(e).done(function(e){return console.log("Exited: "+new Date),e!==!1&&(l+=1),console.log(l)}));return n})}).call(this);