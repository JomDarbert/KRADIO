(function(){var e,t,r,n,u,i,a,l,o,s,c,f,v,d,p,g,h,m,k,A,y,x,w,L,b,D,_,C,F,O=[].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1};for(a="2721807f620a4047d473472d46865f14",SC.initialize({client_id:a}),y=100,b=["kpop","k pop","k-pop","korean","korea","kor","kor pop","korean pop","korean-pop","kor-pop","korean version","kr","kr ver","original"],r=["cover","acoustic","instrumental","remix","mix","re mix","re-mix","version","ver.","live","live cover","accapella","cvr","united states","america","india","indian","japan","china","chinese","japanese","viet","vietnam","vietnamese","thai","taiwan","taiwanese","russian","ambient","meditat"],p=/[^A-Za-z0-9\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF \♡\.\「\」\”\“\’\∞\♥\|\【\】\–\{\}\[\]\!\@\#\$\%\^\&\*\(\)\-\_\=\+\;\:\'\"\,\.\<\>\/\\\?\`\~]/g,o=/[\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF]/g,s=[],d=[],h=document.getElementById("player_one"),k=document.getElementById("player_two"),m=document.getElementById("player_three"),e=null,v=null,g=null,l=function(){var e;return e=null,$.ajax({async:!1,global:!1,url:"../scrape/EYK/tutorial/eyk.json",dataType:"json",success:function(t){e=t}}),e}(),f=function(){var e;return e=null,$.ajax({async:!1,global:!1,url:"../scrape/MWAVE/tutorial/mwave.json",dataType:"json",success:function(t){e=t}}),e}(),L=[],D=0,C=l.length;C>D;D++)w=l[D],w=w.title,w=w.toLowerCase(),L.push(w);for(_=0,F=f.length;F>_;_++)w=f[_],w=w.artist+" "+w.title,w=w.toLowerCase(),L.push(w);L=arrayUnique(L),n=function(e,t){var n,u,i,a,l,o,s,c,f,v,d,g,h,m,k,A,y;if(null==e.title)return!1;if(null==e.url)return!1;if(null==e.created)return!1;if(s=12,a=moment(e.created,"YYYY-MM-DD HH:MM:SS"),l=moment().subtract(s,"months"),l.diff(a,"months")>0)return!1;for(g=0,m=r.length;m>g;g++)if(d=r[g],-1!==e.title.indexOf(d))return!1;for(h=0,k=r.length;k>h;h++)if(d=r[h],null!=e.genre&&-1!==e.genre.indexOf(d))return!1;for(y=0,A=r.length;A>y;y++)if(d=r[y],O.call(e.tags,d)>=0)return!1;return o=p.test(e.title),o===!0?!1:(i=e.title.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),u=t.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),v=i.split(" "),c=u.split(" "),n=[v,c],f=n.shift().reduce(function(e,t){return-1===e.indexOf(t)&&n.every(function(e){return-1!==e.indexOf(t)})&&e.push(t),e},[]),0===f.length?!1:!0)},u=function(e,t){var r,n,u,i,a,l,s,c,f,v,d,p,g,h;for(s=0,f=0,a=0,u=e.title.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),n=t.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),h=e.genre,O.call(b,h)>=0&&(s+=1),p=0,g=b.length;g>p;p++)v=b[p],O.call(e.tags,v)>=0&&(f+=1);return f>0&&(s+=1),d=o.test(e.title),d===!0&&(s+=1),c=u.split(" "),i=n.split(" "),r=[c,i],l=r.shift().reduce(function(e,t){return-1===e.indexOf(t)&&r.every(function(e){return-1!==e.indexOf(t)})&&e.push(t),e},[]),l.length===i.length&&(s+=1),levenstein(n,u)<=10&&(s+=1),s},c=function(e){var t;return t=$.Deferred(),SC.get("/tracks",{q:e,limit:y},function(r){var i;return null==r||0===r.length?(t.resolve(!1),void 0):(i=[],r.forEach(function(t){var r,l,o,s,c,f,v,d,p;return null!=t.title&&(v=t.title.toLowerCase()),null!=t.genre&&(c=t.genre.toLowerCase()),null!=t.tag_list&&(f=t.tag_list.toLowerCase().split(" ")),null!=t.created_at&&(o=t.created_at),null!=t.stream_url&&(d=t.stream_url+"?client_id="+a),null!=t.artwork_url&&(r=t.artwork_url.replace("-large","-t500x500")),null!=t.playback_count&&(p=t.playback_count),null!=t.duration&&(s=t.duration/1e3),w={title:v,genre:c,tags:f,created:o,url:d,artwork:r,duration:s,views:p,score:0,query:e},l=n(w,e),w.score=u(w,e),l===!0&&w.score>=2?i.push(w):void 0}),i.sort(function(e,t){var r;return r=t.score-e.score,0!==r?r:t.views-e.views}),i.length>0?t.resolve(i[0]):t.resolve(!1),void 0)}),t.promise()},t=function(e){var t,r;t=s.length,r=9,null!=e.query&&s.unshift(e.query),t>r&&s.splice(r+1,t-r)},x=function(){var e;return e=L.filter(function(e){return s.indexOf(e)<0}),e=e.filter(function(e){return d.indexOf(e)<0}),e[Math.floor(Math.random()*e.length)]},A=function(e){var r;return r=$.Deferred(),c(e).done(function(n){n!==!1?(t(n),console.log("Loaded song: "+n.title),r.resolve(n)):(d.push(e),console.log("Error loading song: "+n.query),r.resolve(!1))}),r.promise()},i=function(){var e,t,r,n;return r=[h,k,m],e=r.indexOf(document.getElementsByClassName("active")[0]),t=r.length,null==e?(console.log("no current active"),n={active:r[0],next:r[1],onDeck:r[2],last:r[e]}):0===e?(n={active:r[1],next:r[2],onDeck:r[0],last:r[e]},n.active.classList.add("active"),n.next.classList.remove("active"),n.onDeck.classList.remove("active"),n):1===e?(n={active:r[2],next:r[0],onDeck:r[1],last:r[e]},n.active.classList.add("active"),n.next.classList.remove("active"),n.onDeck.classList.remove("active"),n):2===e?(n={active:r[0],next:r[1],onDeck:r[2],last:r[e]},n.active.classList.add("active"),n.next.classList.remove("active"),n.onDeck.classList.remove("active"),n):void 0},$("#test").on("click",function(){var e,t;return e=i(),t=x(),A(t).done(function(r){return r!==!1?(e.last.pause(),e.active.play(),e.last.setAttribute("src",r.url)):(d.push(t),t=x(),A(t).done(function(r){return r!==!1?(e.active.setAttribute("src",r.url),e.last.pause(),e.active.play()):(d.push(t),t=x(),A(t).done(function(t){return e.active.setAttribute("src",t.url),e.last.pause(),e.active.play()}))}))})}),$(document).ready(function(){var e;e=x(),A(e).done(function(t){return t!==!1?h.setAttribute("src",t.url):(d.push(e),e=x(),A(e).done(function(t){return t!==!1?h.setAttribute("src",t.url):(d.push(e),e=x(),A(e).done(function(e){return h.setAttribute("src",e.url)}))})),e=x(),A(e).done(function(t){return t!==!1?k.setAttribute("src",t.url):(d.push(e),e=x(),A(e).done(function(t){return t!==!1?k.setAttribute("src",t.url):(d.push(e),e=x(),A(e).done(function(e){return k.setAttribute("src",e.url)}))})),e=x(),A(e).done(function(t){return t!==!1?m.setAttribute("src",t.url):(d.push(e),e=x(),A(e).done(function(t){return t!==!1?m.setAttribute("src",t.url):(d.push(e),e=x(),A(e).done(function(e){return m.setAttribute("src",e.url)}))}))})})})})}).call(this);