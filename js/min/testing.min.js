(function(){var e,t,r,n,a,i,l,o,u,s,c,f,v,d,g,p,m,h,k,x,y,w,L,A,D,_,C,F,b,j=[].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1};for(l="2721807f620a4047d473472d46865f14",SC.initialize({client_id:l}),y=100,D=["kpop","k pop","k-pop","korean","korea","kor","kor pop","korean pop","korean-pop","kor-pop","korean version","kr","kr ver","original"],r=["cover","acoustic","instrumental","remix","mix","re mix","re-mix","version","ver.","live","live cover","accapella","cvr","united states","america","india","indian","japan","china","chinese","japanese","viet","vietnam","vietnamese","thai","taiwan","taiwanese","russian","ambient","meditat"],g=/[^A-Za-z0-9\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF \♡\.\「\」\”\“\’\∞\♥\|\【\】\–\{\}\[\]\!\@\#\$\%\^\&\*\(\)\-\_\=\+\;\:\'\"\,\.\<\>\/\\\?\`\~]/g,u=/[\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF]/g,s=[],d=[],m=document.getElementById("player_one"),k=document.getElementById("player_two"),h=document.getElementById("player_three"),e=null,v=null,p=null,o=function(){var e;return e=null,$.ajax({async:!1,global:!1,url:"../scrape/EYK/tutorial/eyk.json",dataType:"json",success:function(t){e=t}}),e}(),f=function(){var e;return e=null,$.ajax({async:!1,global:!1,url:"../scrape/MWAVE/tutorial/mwave.json",dataType:"json",success:function(t){e=t}}),e}(),A=[],_=0,F=o.length;F>_;_++)L=o[_],L=L.title,L=L.toLowerCase(),A.push(L);for(C=0,b=f.length;b>C;C++)L=f[C],L=L.artist+" "+L.title,L=L.toLowerCase(),A.push(L);A=arrayUnique(A),n=function(e,t){var n,a,i,l,o,u,s,c,f,v,d,p,m,h,k,x,y;if(null==e.title)return!1;if(null==e.url)return!1;if(null==e.created)return!1;if(s=12,l=moment(e.created,"YYYY-MM-DD HH:MM:SS"),o=moment().subtract(s,"months"),o.diff(l,"months")>0)return!1;for(p=0,h=r.length;h>p;p++)if(d=r[p],-1!==e.title.indexOf(d))return!1;for(m=0,k=r.length;k>m;m++)if(d=r[m],null!=e.genre&&-1!==e.genre.indexOf(d))return!1;for(y=0,x=r.length;x>y;y++)if(d=r[y],j.call(e.tags,d)>=0)return!1;return u=g.test(e.title),u===!0?!1:(i=e.title.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),a=t.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),v=i.split(" "),c=a.split(" "),n=[v,c],f=n.shift().reduce(function(e,t){return-1===e.indexOf(t)&&n.every(function(e){return-1!==e.indexOf(t)})&&e.push(t),e},[]),0===f.length?!1:!0)},a=function(e,t){var r,n,a,i,l,o,s,c,f,v,d,g,p,m;for(s=0,f=0,l=0,a=e.title.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),n=t.replace(/[^A-Za-z0-9\s]+/g,"").replace(/\s+/g," ").toLowerCase().trim(),m=e.genre,j.call(D,m)>=0&&(s+=1),g=0,p=D.length;p>g;g++)v=D[g],j.call(e.tags,v)>=0&&(f+=1);return f>0&&(s+=1),d=u.test(e.title),d===!0&&(s+=1),c=a.split(" "),i=n.split(" "),r=[c,i],o=r.shift().reduce(function(e,t){return-1===e.indexOf(t)&&r.every(function(e){return-1!==e.indexOf(t)})&&e.push(t),e},[]),o.length===i.length&&(s+=1),levenstein(n,a)<=10&&(s+=1),s},c=function(e){var t;return t=$.Deferred(),SC.get("/tracks",{q:e,limit:y},function(r){var i;return null==r||0===r.length?(t.reject(),void 0):(i=[],r.forEach(function(t){var r,o,u,s,c,f,v,d,g;return null!=t.title&&(v=t.title.toLowerCase()),null!=t.genre&&(c=t.genre.toLowerCase()),null!=t.tag_list&&(f=t.tag_list.toLowerCase().split(" ")),null!=t.created_at&&(u=t.created_at),null!=t.stream_url&&(d=t.stream_url+"?client_id="+l),null!=t.artwork_url&&(r=t.artwork_url.replace("-large","-t500x500")),null!=t.playback_count&&(g=t.playback_count),null!=t.duration&&(s=t.duration/1e3),L={title:v,genre:c,tags:f,created:u,url:d,artwork:r,duration:s,views:g,score:0,query:e},o=n(L,e),L.score=a(L,e),o===!0&&L.score>=2?i.push(L):void 0}),i.sort(function(e,t){var r;return r=t.score-e.score,0!==r?r:t.views-e.views}),i.length>0?t.resolve(i[0]):t.reject(),void 0)}),t.promise()},t=function(e){var t,r;t=s.length,r=9,null!=e.query&&s.unshift(e.query),t>r&&s.splice(r+1,t-r)},w=function(){var e;return e=A.filter(function(e){return s.indexOf(e)<0}),e=e.filter(function(e){return d.indexOf(e)<0}),e[Math.floor(Math.random()*e.length)]},x=function(e){var r,n;return n=function(e){return c(e).done(function(e){return t(e),console.log("Loaded song: "+e.title),r.resolve(e)}).fail(function(){var t;return d.push(e),console.log("Error loading song: "+L.query),t=w(),n(t)})},r=$.Deferred(),n(e),r.promise()},i=function(){var e,t,r,n;return r=[m,k,h],e=r.indexOf(document.getElementsByClassName("active")[0]),t=r.length,null==e?(console.log("no current active"),n={active:r[0],next:r[1],onDeck:r[2],last:r[e]}):0===e?(n={active:r[1],next:r[2],onDeck:r[0],last:r[e]},n.active.classList.add("active"),n.next.classList.remove("active"),n.onDeck.classList.remove("active"),n):1===e?(n={active:r[2],next:r[0],onDeck:r[1],last:r[e]},n.active.classList.add("active"),n.next.classList.remove("active"),n.onDeck.classList.remove("active"),n):2===e?(n={active:r[0],next:r[1],onDeck:r[2],last:r[e]},n.active.classList.add("active"),n.next.classList.remove("active"),n.onDeck.classList.remove("active"),n):void 0},$("#test").on("click",function(){var e,t;return e=i(),t=w(),x(t).done(function(t){return console.log(t),e.last.pause(),e.active.play(),e.last.setAttribute("src",t.url)})}),$(document).ready(function(){var e,t,r;return e=w(),r=w(),t=w(),x(e).done(function(e){return m.setAttribute("src",e.url)}),x(r).done(function(e){return k.setAttribute("src",e.url)}),x(t).done(function(e){return h.setAttribute("src",e.url)})})}).call(this);